<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project and Task Viewer</title>
</head>
<body>
    <h1>Projects and Tasks</h1>
    <div id="content"></div>

    <script>
        async function fetchProjectsAndTasks() {
            try {
                const projectResponse = await fetch('http://localhost:8080/projects');
                const projects = await projectResponse.json();

                const taskResponse = await fetch('http://localhost:8080/tasks');
                const tasks = await taskResponse.json();

                const contentDiv = document.getElementById('content');
                contentDiv.innerHTML = ''; // Clear any previous content

                projects.forEach(project => {
                    // Create a section for each project
                    const projectDiv = document.createElement('div');
                    projectDiv.innerHTML = `<h2>Project: ${project.Name}</h2><p>${project.Description || 'No Description'}</p>`;
                    
                    // Filter tasks by project ID
                    const projectTasks = tasks.filter(task => task.ProjectID === project.ID);
                    
                    if (projectTasks.length > 0) {
                        const taskList = document.createElement('ul');
                        projectTasks.forEach(task => {
                            const taskItem = document.createElement('li');
                            taskItem.textContent = `Task ${task.ID}: ${task.Title} - ${task.Status}`;
                            taskList.appendChild(taskItem);
                        });
                        projectDiv.appendChild(taskList);
                    } else {
                        const noTasks = document.createElement('p');
                        noTasks.textContent = 'No tasks for this project';
                        projectDiv.appendChild(noTasks);
                    }

                    contentDiv.appendChild(projectDiv);
                });
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        // Fetch and display data when the page loads
        fetchProjectsAndTasks();
    </script>
</body>
</html>
